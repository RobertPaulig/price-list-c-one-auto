# Системные паттерны

## Архитектура приложения
Прайс-лист C-ONE AUTO построен на основе одностраничного приложения (SPA) с использованием React и TypeScript. Архитектура приложения относительно простая и состоит из следующих основных компонентов:

1. **Основной компонент App** - центральный компонент приложения, который управляет состоянием и отображает остальные компоненты
2. **Компонент PriceTable** - отвечает за отображение таблиц с тарифами для каждой категории
3. **Компонент Calculator** - реализует интерактивный калькулятор стоимости доставки

Приложение не использует сложных архитектурных паттернов, таких как Redux или Context API, поскольку не требует управления сложным глобальным состоянием.

## Ключевые технические решения

### 1. Парсинг данных из текстового формата
Данные прайс-листа хранятся в текстовом формате (строковая константа) и преобразуются в структурированные данные с помощью функции `parsePriceData()`. Это решение было выбрано для упрощения обновления данных без необходимости изменения структуры кода.

### 2. Обработка многоязычности
Многоязычность реализована с помощью функции перевода `t()`, которая использует словарь переводов `chineseTranslations`. Изначально был рассмотрен вариант с использованием API Gemini для автоматического перевода, но от него отказались в пользу статических переводов.

### 3. Интерактивный расчет стоимости
Калькулятор стоимости использует логику расчета на основе следующих данных:
- Категория товара
- Вес и объем груза (для расчета плотности)
- Город назначения (Москва или Алматы)
- Тип цены (Цена 1 или Цена 2)

Логика учитывает особые случаи, такие как грузы с плотностью менее 100 кг/м³, для которых цена устанавливается за кубический метр, а не за килограмм.

### 4. Переключение видимости таблиц
Реализовано состояние `visibleCategories`, которое хранит информацию о том, какие категории в данный момент развернуты, а какие свернуты. Это позволяет пользователю сфокусироваться только на интересующих его категориях.

## Паттерны разработки

### 1. Компонентный подход
Приложение структурировано в виде компонентов с четко определенными обязанностями, что повышает переиспользуемость кода и упрощает его сопровождение.

### 2. Функциональные компоненты и хуки
Все компоненты реализованы как функциональные с использованием хуков React (useState, useEffect, useCallback), что соответствует современным практикам разработки React-приложений.

### 3. Типизация с использованием TypeScript
Определены четкие интерфейсы для данных (PriceItem, PriceCategory, ParsedData), что улучшает надежность кода и документирование структуры данных.

### 4. Разделение логики и представления
Логика парсинга данных, расчета стоимости и управления состоянием отделена от компонентов отображения, что упрощает поддержку и тестирование.

## Стратегия обработки данных

### 1. Хранение данных
Данные прайс-листа хранятся непосредственно в исходном коде приложения в виде текстовой константы `rawPriceData`. Это упрощает обновление прайс-листа (достаточно изменить текстовую константу).

### 2. Преобразование данных
Текстовые данные преобразуются в структурированный формат при инициализации приложения с помощью функции `parsePriceData()`. Результат сохраняется в состоянии компонента и используется для отображения и расчетов.

### 3. Кэширование переводов
Переводы на китайский язык хранятся в статическом объекте `chineseTranslations`, что устраняет необходимость динамического перевода и улучшает производительность приложения.

## Взаимодействие компонентов

### 1. App → PriceTable
Основной компонент передает данные категорий и функцию перевода компоненту таблицы для отображения.

### 2. App → Calculator
Компоненту калькулятора передаются данные категорий, функция перевода и текущий язык интерфейса.

### 3. Общие шаблоны взаимодействия
Компоненты взаимодействуют через пропсы, без использования сложных механизмов передачи данных, что соответствует философии React для приложений с относительно простой структурой. 